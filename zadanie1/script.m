% Очистка рабочей области и консоли
clear all; clc;

% =========================================================
% 1. Задаем параметры для решения уравнения
% =========================================================

% Функция для итераций (преобразованная форма уравнения)
phi = @(x) 1 ./ sqrt(x + 1); % @(x) - функция от x

% Требуемая точность вычислений
epsilon = 1e-4;

% Интервал, где ищем корень
a = 0.6;
b = 0.8;

% Специальный коэффициент (получен из предыдущих расчетов)
q = 0.2471;

% Вычисляем вспомогательную величину для критерия остановки
epsilon0 = ((1 - q) / q) * epsilon;

% Начальное приближение (точка, с которой начинаем поиск)
x0 = 0.6;

% =========================================================
% 2. Форматируем вывод результатов
% =========================================================

fprintf('Метод простой итерации:\n');
fprintf('Требуемая точность ε = %.6f\n', epsilon);
fprintf('Коэффициент q = %.6f\n', q);
fprintf('Вычисленная точность ε0 = %.6f\n', epsilon0);

% Заголовки таблицы результатов
fprintf('\n№ итерации | Корень | Разность | Точность\n');
fprintf('-----------------------------------------\n');

% =========================================================
% 3. Основной цикл вычислений
% =========================================================

% Начинаем с начального приближения
x_prev = x0;
k = 0;
diff = 1;


while diff > epsilon0
    % Вычисляем новое приближение
    x_next = phi(x_prev);

    k = k + 1;

    % Считаем разницу между текущим и предыдущим значением
    diff = abs(x_next - x_prev);

    % Выводим результаты текущей итерации
    fprintf('%2d | %14.6f | %12.6f | %.6f\n', k, x_next, diff, epsilon0);
##
##    % Проверяем условие остановки
##    if diff <= epsilon0
##        break; % Если условие выполнено - выходим из цикла
##    end

    % Переходим к следующей итерации
    x_prev = x_next;
end

% =========================================================
% 4. Выводим итоговый результат
% =========================================================

fprintf('\nНайден корень уравнения: x ≈ %.6f\n', x_next);

